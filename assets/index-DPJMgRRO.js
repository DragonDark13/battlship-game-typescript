var T=Object.defineProperty;var D=(e,t,s)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var y=(e,t,s)=>(D(e,typeof t!="symbol"?t+"":t,s),s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();const a={init:"Drag your ships to the map.",start:"Please click start to proceed","your turn":"Your turn! Find and destroy all five enemy ships",won:"You won!!",lost:"Tough luck!! Computer won!",hit:"Boom, enemy ship is hit",miss:"Oops, nothing there","already hit":"This cell is already hit. Try a new target",computer:"Computer thinking...","computer hit":"Computer hit your ship","computer miss":"Computer missed",destroyer:"A destroyer is sunk!",submarine:"A submarine is sunk!",cruiser:"A cruiser is sunk!",battleship:"A battleship is sunk!",career:"A career is sunk!"},N=e=>{const t=g.find(n=>n.name===e).size,s=h==="player"?v.filter(n=>n===e).length:z.filter(n=>n===e).length;return t===s?(h==="player"?O.push(e):S.push(e),!0):!1},L=document.getElementById("message"),c=e=>{L.style.opacity="0",setTimeout(()=>{L.innerHTML=e,L.style.opacity="1"},250)};c(a.init);let d=!1;const w=()=>{const t=[...document.getElementById("ships").children];d?t.forEach(s=>s.classList.remove("rotated")):t.forEach(s=>s.classList.add("rotated")),d=!d};document.getElementById("rotate").addEventListener("click",w);const I=e=>{for(let t=0;t<100;t++){const s=document.createElement("div");s.classList.add("cell"),s.id=`cell-${t}`,e.append(s)}},E=document.getElementById("player");I(E);const k=document.getElementById("computer");I(k);class f{constructor(t,s){y(this,"name");y(this,"size");this.name=t,this.size=s}}const P=new f("destroyer",2),x=new f("submarine",3),H=new f("cruiser",3),F=new f("battleship",4),G=new f("career",5),g=[P,x,H,F,G],b=(e,t,s,n,r)=>{const i=r==="computer"?k:E,o=Array.from(i.getElementsByClassName("cell"));return new Array(e).fill(-1).map((M,A)=>n?t*10+s+A*10:t*10+s+A).map(M=>o[M])},q=e=>{for(;;){const t=Math.random()<.5,s=Math.floor(t?Math.random()*10:Math.random()*(10-e.size)),n=Math.floor(t?Math.random()*(10-e.size):Math.random()*10),r=b(e.size,s,n,t,"computer");if(r.every(i=>i!==void 0)&&r.every(i=>!i.classList.contains("taken")&&!0)){r.forEach(i=>i.classList.add("taken",e.name));break}}};g.forEach(e=>q(e));const V=Array.from(document.querySelectorAll("#ships div")),Y=e=>{u=e.target.classList[0]},l=Array.from(E.getElementsByClassName("cell")),$=Array.from(k.getElementsByClassName("cell")),p=Array.from(document.querySelectorAll("#ships div")),K=e=>{var i;const t=((i=g.find(o=>o.name===u))==null?void 0:i.size)||0,s=Math.floor(e/10),n=e-s*10;return b(t,s,n,d,"player").some(o=>o&&o.classList.contains("taken"))?!1:d?!(t+s>10):!(t+n>10)},R=e=>{e.preventDefault();const t=e.target.id,s=Number(t.split("cell-")[1]);K(s)&&j(s)},_=e=>{e.preventDefault(),l.forEach(t=>t.classList.remove("highlight"))},j=e=>{var i;const t=((i=g.find(o=>o.name===u))==null?void 0:i.size)||0,s=Math.floor(e/10),n=e-s*10,r=b(t,s,n,d,"player");console.log("validCells",r),r.forEach(o=>o.classList.add("highlight"))};let u="";const J=e=>{var n,r,i;if(console.log(e.target),e.preventDefault(),l.filter(o=>o.classList.contains("highlight")).length===0)return;l.forEach(o=>{o.classList.contains("highlight")&&(o.classList.remove("highlight"),o.classList.add("taken"),o.classList.add(u))});const s=p.findIndex(o=>o.classList.contains(u));s!=-1&&(p[s].remove(),p.splice(s,1)),console.log(u),p.length===0&&((n=document.getElementById("rotate"))==null||n.removeEventListener("click",w),(r=document.getElementById("rotate"))==null||r.setAttribute("disabled","true"),(i=document.getElementById("start"))==null||i.removeAttribute("disabled"),c(a.start))};let m=!1,h="computer";const v=[],z=[],O=[],S=[],Q=()=>{var e;h="player",$.forEach(t=>t.addEventListener("click",X)),(e=document.getElementById("start"))==null||e.setAttribute("disabled","true"),c(a["your turn"])};var B;(B=document.getElementById("start"))==null||B.addEventListener("click",Q);l.forEach(e=>{e.addEventListener("dragover",R),e.addEventListener("dragleave",_),e.addEventListener("drop",J)});const C=()=>{if(O.length===5){c(a.won),m=!0;return}if(S.length===5){c(a.lost),m=!0;return}},U=()=>{const e=l.filter(n=>n.classList.contains("hit")).filter(n=>{const r=/cell taken (.+?) hit/,i=n.classList.toString().match(r),o=(i==null?void 0:i[1])||"";return!S.includes(o)}),t=new Set;return e.forEach(n=>{const r=Number(n.id.split("cell-")[1]);r%10!==0&&t.add(r-1),r%10!==9&&t.add(r+1),r>9&&t.add(r-1),r<90&&t.add(r-1)}),[...t].map(n=>l.find(r=>r.id===`cell-${n}`)).filter(n=>!(n!=null&&n.classList.contains("hit"))&&!(n!=null&&n.classList.contains("miss")))},W=()=>{C(),!m&&(c(a.computer),setTimeout(()=>{const e=U();let t;if(e.length)t=e[Math.floor(Math.random()*e.length)];else{const s=l.filter(n=>!n.classList.contains("miss")&&!n.classList.contains("hit"));t=s[Math.floor(Math.random()*s.length)]}if(t.classList.contains("taken")){const s=t.classList.toString().split("cell taken ")[1];z.push(s),c(a["computer hit"]),t.classList.add("hit")}else c(a["computer miss"]),t.classList.add("miss")},1e3),setTimeout(()=>{C(),!m&&(c(a["your turn"]),h="player")},2e3))},X=e=>{if(!m){if(h==="player"){const t=e.target;if(t.classList.contains("hit")||t.classList.contains("miss")){c(a["already hit"]);return}if(t.classList.contains("taken")){const s=t.classList.toString().split("cell taken ")[1];v.push(s),t.classList.add("hit"),c(a.hit),N(s)?c(a[s]):c(a.hit)}else c(a.miss),t.classList.add("miss");h="computer",setTimeout(W,1e3)}console.log(v)}};V.forEach(e=>e.addEventListener("mousedown",Y));
